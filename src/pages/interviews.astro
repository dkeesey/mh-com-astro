---
import Layout from "../layouts/Layout.astro";
import { AudioPlayer } from "@components/ui/AudioPlayer";
import { interviewAudioFiles } from '../data/interview-audio';
---

<Layout title="Oral History Interviews - Japanese American Concentration Camps">
  <main class="min-h-screen bg-museum-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
      <header class="mb-16">
        <h1 class="text-5xl font-bold text-gray-900 mb-8 font-robotoCondensed">Oral History Interviews</h1>
        <p class="text-2xl text-gray-700 max-w-4xl leading-relaxed">
          Listen to firsthand accounts from Japanese Americans who experienced life in the concentration camps during World War II. 
          These interviews provide valuable historical perspectives and personal stories that help us understand this critical period 
          in American history.
        </p>
      </header>

      <div class="max-w-4xl mx-auto bg-gray-900/95 rounded-xl p-8 shadow-2xl">
        <div id="audio-player-container">
          <AudioPlayer 
            client:load
            tracks={interviewAudioFiles}
            currentTrackIndex={0}
          />
        </div>
      </div>
    </div>
  </main>
</Layout>

<style>
  :global(.plyr) {
    --plyr-color-main: #4f46e5;
    --plyr-audio-controls-background: transparent;
    --plyr-audio-control-color: #ffffff;
    --plyr-audio-control-color-hover: #4f46e5;
    --plyr-audio-control-background-hover: transparent;
    font-size: 1.2rem;
  }

  :global(.plyr--audio .plyr__control:hover) {
    background: transparent;
  }

  :global(.plyr--audio .plyr__controls button:hover) {
    background: transparent;
  }
</style>

<script define:vars={{ interviewAudioFiles }}>
  document.addEventListener('DOMContentLoaded', () => {
    const container = document.getElementById('audio-player-container');
    if (container) {
      const currentTrack = parseInt(container.dataset.currentTrack || '0');
      const audioPlayer = container.querySelector('.plyr');
      if (audioPlayer) {
        // @ts-ignore
        const plyr = audioPlayer.plyr;
        if (plyr) {
          plyr.source = {
            type: 'audio',
            sources: [{ src: interviewAudioFiles[currentTrack].url }]
          };
          plyr.play();
        }
      }
    }
  });
</script>
